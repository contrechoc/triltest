
#include <Arduino.h>
#include <IRremote.hpp>

uint16_t sAddress = 0x0102;
uint8_t sCommand = 0x10;
uint8_t sRepeats = 0;

int counter;

void setup() {

  pinMode(LED_BUILTIN, OUTPUT);
  Serial.begin(115200);

//for the IR receiver
  pinMode(6, OUTPUT);
  digitalWrite(6, HIGH);
  pinMode(5, OUTPUT);
  digitalWrite(5, LOW);

//for the button 11 and 12 are 5V and GND - input on 10
  pinMode(11, OUTPUT);
  digitalWrite(11, HIGH);
  pinMode(12, OUTPUT);
  digitalWrite(12, LOW);
  pinMode(10, INPUT);
  digitalWrite(10, HIGH); //pull up

//for the led - indicating the tracks
  pinMode(2, OUTPUT);
  pinMode(3, OUTPUT);
  digitalWrite(3, LOW);

  //blinking the led for starting up
  digitalWrite(2, HIGH);
  delay(500);
  digitalWrite(2, LOW);
}


void loop() {

  int h = digitalRead( 10); 
  if (digitalRead(10) == 0 ) //input on getting LOW from the button
  {
    if ( sCommand == 0x10 )
      sCommand = 0x11;
    else if ( sCommand == 0x11 )
      sCommand = 0x12;
    else if ( sCommand == 0x12 )
      sCommand = 0x14;
    else if ( sCommand == 0x14 )
      sCommand = 0x10;
    Serial.print (" sending command: ");
    Serial.println(sCommand);
    digitalWrite(2, HIGH);
    delay(2000);
    digitalWrite(2, LOW);
    delay(2000);
  }

  IRSEND(7);

}

void IRSEND(int whichPIN) {

  IrSender.begin(whichPIN); // Start with IR_SEND_PIN as send pin and if NO_LED_FEEDBACK_CODE is NOT defined, enable feedback LED at default feedback LED pin
  Serial.print(F("Ready to send IR signals at pin "));
  Serial.print("  ");
  Serial.print(whichPIN);
  Serial.print("  ");
  Serial.print (" sending command: ");
  Serial.println(sCommand);
  delay(200 );

  sAddress = 0x102;
  //sCommand = 0x10;

  IrSender.sendNEC(sAddress, sCommand, 2);

  for (int i = 0; i < sCommand - 0x10+1; i++) {
    digitalWrite(2, HIGH);
    delay(100);
    digitalWrite(2, LOW);
    delay(100);
  }
  delay(500);

}
